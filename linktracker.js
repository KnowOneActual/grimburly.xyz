const linksData = {
  'AI & Content Creation': [
    {
      name: 'GenSpark',
      url: 'https://www.genspark.im/try',
      desc: 'AI super agent search platform creating custom summary pages.',
    },
    {
      name: 'Omakub',
      url: 'https://omakub.org/',
      desc: 'Ubuntu dev environment setup script by DHH.',
    },
    {
      name: 'Magic Loops',
      url: 'https://magicloops.dev/pricing',
      desc: 'Programmable AI automation platform for custom workflows.',
    },
    {
      name: 'Butternut AI',
      url: 'https://www.butternut.ai/?ref=dominik19',
      desc: 'AI website builder generating multi-page websites from text prompts.',
    },
    {
      name: 'Text-to-CAD',
      url: 'https://text-to-cad.zoo.dev/',
      desc: 'AI converts text descriptions into editable CAD models.',
    },
    {
      name: 'Backflip AI',
      url: 'https://www.backflip.ai/',
      desc: 'Turns text or images into manufacturable 3D models.',
    },
    {
      name: 'Brainrot AI',
      url: 'https://brainrotai.net/',
      desc: 'Viral video generator for social media content.',
    },
    {
      name: 'Napkin AI',
      url: 'https://app.napkin.ai/signin',
      desc: 'Converts documents into diagrams and charts for presentations.',
    },
    {
      name: 'Gamma App',
      url: 'https://gamma.app/',
      desc: 'AI presentation tool generating slide decks from text.',
    },
    {
      name: 'TwainGPT',
      url: 'https://www.twaingpt.com/',
      desc: 'AI writing assistant for humanizing generated text.',
    },
    {
      name: 'Suno Music',
      url: 'https://suno.com/home',
      desc: 'AI music generation platform creating full songs.',
    },
    {
      name: 'NotebookLM',
      url: 'https://notebooklm.google.com/',
      desc: "Google's AI research assistant with podcast generation.",
    },
    {
      name: 'Photocatch',
      url: 'https://www.photocatch.app/',
      desc: 'Photogrammetry tool creating 3D models from photos.',
    },
    {
      name: 'Freepik AI',
      url: 'https://www.freepik.com/ai',
      desc: 'AI image generator integrated with stock assets.',
    },
    {
      name: 'Flux Pro',
      url: 'https://fal.ai/models/fal-ai/flux-pro/v1.1',
      desc: 'Flux Pro AI image generation via API.',
    },
    {
      name: 'Pika Art',
      url: 'https://pika.art/login',
      desc: 'AI video generation from images and text.',
    },
    {
      name: 'Meshy AI',
      url: 'https://www.meshy.ai/',
      desc: '3D textures and models for game development.',
    },
    {
      name: 'Wispr Flow',
      url: 'https://wisprflow.ai/pricing',
      desc: 'Voice-to-text dictation tool for writing.',
    },
    {
      name: 'My Ninja AI',
      url: 'https://myninja.ai/',
      desc: 'AI research assistant aggregating information.',
    },
    {
      name: 'Chat Free AI',
      url: 'https://chatfreeai.com/',
      desc: 'Directory of free AI chat tools.',
    },
    {
      name: 'Haikei',
      url: 'https://app.haikei.app/',
      desc: 'Abstract background and design generator.',
    },
    {
      name: 'LookUps',
      url: 'https://lookups.io/signin',
      desc: 'Data lookup and verification service.',
    },
    {
      name: 'TuneMyMusic',
      url: 'https://www.tunemymusic.com/transfer?mode=tidal#step1',
      desc: 'Transfer playlists between music streaming services.',
    },
    {
      name: 'Tangled',
      url: 'https://tangled.org/login',
      desc: 'Collaborative knowledge and note-taking platform.',
    },
    {
      name: 'Cursor AI',
      url: 'https://www.cursor.com/',
      desc: 'AI-powered code editor for accelerated development.',
    },
    {
      name: 'V0 Dev',
      url: 'https://v0.dev/',
      desc: 'Generative UI platform for building with AI.',
    },
    {
      name: 'Replit AI',
      url: 'https://replit.com/',
      desc: 'Collaborative IDE with built-in AI assistant.',
    },
    {
      name: 'Vercel AI',
      url: 'https://vercel.com/ai',
      desc: 'AI SDK and templates for building AI applications.',
    },
    {
      name: 'OpenAI Playground',
      url: 'https://platform.openai.com/playground',
      desc: 'Interactive testing environment for OpenAI models.',
    },
    {
      name: 'Claude Web',
      url: 'https://claude.ai/',
      desc: 'Web interface for Claude AI model.',
    },
    {
      name: 'Perplexity AI',
      url: 'https://www.perplexity.ai/',
      desc: 'AI search engine with reasoning capabilities.',
    },
    {
      name: 'Hugging Face',
      url: 'https://huggingface.co/',
      desc: 'Hub for ML models, datasets, and applications.',
    },
  ],
  'Audio, Music & Production': [
    {
      name: 'SyndtSphere',
      url: 'https://klevgrand.com/products/syndtsphere',
      desc: 'Spherical synthesizer plugin with preset surfing.',
    },
    {
      name: 'Tracktion Zyklop',
      url: 'https://www.tracktion.com/products/zyklop',
      desc: 'Free synthesizer with Re-synthesis engine.',
    },
    {
      name: 'VocalFIXit Suite',
      url: 'https://www.psychocircuitry.com/vfis.html',
      desc: 'Audio plugins fixing vocal recording issues.',
    },
    {
      name: 'SonoBus',
      url: 'https://sonobus.net/',
      desc: 'Low-latency audio streaming for remote collaboration.',
    },
    {
      name: 'Vital Audio',
      url: 'https://vital.audio/',
      desc: 'Spectral wavetable synthesizer alternative to Serum.',
    },
    {
      name: 'ToneBoosters',
      url: 'https://www.toneboosters.com/changelog.html',
      desc: 'Quality audio mixing and mastering plugins.',
    },
    {
      name: 'UJAM Finisher',
      url: 'https://www.ujam.com/finisher/micro/',
      desc: 'Free multi-effect plugin for instant polish.',
    },
    {
      name: 'Roex Audio',
      url: 'https://www.roexaudio.com/',
      desc: 'Audio mixing tools and professional plugins.',
    },
    {
      name: 'Ultimate Vocal Remover',
      url: 'https://ultimatevocalremover.com/',
      desc: 'AI tool separating vocals from instruments.',
    },
    {
      name: 'Every Noise',
      url: 'https://everynoise.com/',
      desc: 'Music genre visualization from Spotify data.',
    },
    {
      name: 'Qobuz',
      url: 'https://www.qobuz.com/us-en/music/streaming/offers',
      desc: 'High-fidelity music streaming service.',
    },
    {
      name: 'S-Doubler',
      url: 'https://www.solidersound.com/plugins/s-doubler/',
      desc: 'Stereo widening and doubling effects plugin.',
    },
    {
      name: 'Vocal Menace',
      url: 'https://www.mymusicalvoice.com/p/vocal-menace-by-chris-liepe',
      desc: 'Vocal training and improvement course.',
    },
    {
      name: 'Splice',
      url: 'https://www.splice.com/',
      desc: 'Cloud storage and collaboration for music production.',
    },
    {
      name: 'BeatStars',
      url: 'https://www.beatstars.com/',
      desc: 'Platform for producers to sell beats and samples.',
    },
    {
      name: 'LANDR',
      url: 'https://www.landr.com/',
      desc: 'AI mastering and distribution platform for musicians.',
    },
    {
      name: 'Soundtrap',
      url: 'https://www.soundtrap.com/',
      desc: 'Browser-based music production suite.',
    },
    {
      name: 'Audacity',
      url: 'https://www.audacityteam.org/',
      desc: 'Free, open-source audio editing software.',
    },
  ],
  'Software Development & Technical Tools': [
    {
      name: 'VERT.sh',
      url: 'https://vert.sh/',
      desc: 'Browser-based local file converter for media.',
    },
    {
      name: 'Jam Dev Utilities',
      url: 'https://jam.dev/utilities',
      desc: 'Collection of developer utilities and tools.',
    },
    {
      name: 'Cobalt Tools',
      url: 'https://cobalt.tools/settings/advanced',
      desc: 'Media downloader from various platforms.',
    },
    {
      name: 'Regex101',
      url: 'https://regex101.com/',
      desc: 'Interactive regex testing and debugging tool.',
    },
    {
      name: 'Docling',
      url: 'https://github.com/docling-project/docling',
      desc: 'Document processing library for data extraction.',
    },
    {
      name: 'Oh My Git',
      url: 'https://ohmygit.org/',
      desc: 'Interactive game teaching Git version control.',
    },
    {
      name: 'CheckIO',
      url: 'https://py.checkio.org/',
      desc: 'Gamified platform for Python programming.',
    },
    {
      name: 'Anthropic Console',
      url: 'https://console.anthropic.com/login',
      desc: 'Portal for accessing Claude API.',
    },
    {
      name: 'Keygen',
      url: 'https://keygen.co/',
      desc: 'Software licensing and distribution API.',
    },
    {
      name: 'Censys Search',
      url: 'https://search.censys.io',
      desc: 'Search engine for internet-connected devices.',
    },
    {
      name: 'CodeSignal',
      url: 'https://codesignal.com',
      desc: 'Technical assessment and coding interview platform.',
    },
    {
      name: 'CopyParty',
      url: 'https://github.com/9001/copyparty?tab=readme-ov-file#quickstart',
      desc: 'Simple file sharing and syncing tool.',
    },
    {
      name: 'App Ideas',
      url: 'https://github.com/florinpop17/app-ideas',
      desc: 'Collection of project ideas for learning.',
    },
    {
      name: 'Project-Based Learning',
      url: 'https://github.com/practical-tutorials/project-based-learning',
      desc: 'Curated project-based learning resources.',
    },
    {
      name: 'Kaushik Gopal Dotfiles',
      url: 'https://github.com/kaushikgopal/dotfiles/blob/master/bin/usbi',
      desc: 'Developer dotfiles and configuration.',
    },
    {
      name: 'Nutro Cloud',
      url: 'https://nutro.cloud/free-hosting',
      desc: 'Free hosting platform.',
    },
    {
      name: 'GitHub Copilot',
      url: 'https://github.com/features/copilot',
      desc: 'AI pair programmer for coding assistance.',
    },
    {
      name: 'Stack Overflow',
      url: 'https://stackoverflow.com/',
      desc: 'Community Q&A platform for developers.',
    },
    {
      name: 'DevDocs',
      url: 'https://devdocs.io/',
      desc: 'Offline documentation aggregator for developers.',
    },
    {
      name: 'MDN Web Docs',
      url: 'https://developer.mozilla.org/',
      desc: 'Comprehensive web development documentation.',
    },
    {
      name: 'CSS-Tricks',
      url: 'https://css-tricks.com/',
      desc: 'Daily articles on web design and development.',
    },
    {
      name: 'Smashing Magazine',
      url: 'https://www.smashingmagazine.com/',
      desc: 'Web design and development resources.',
    },
    {
      name: 'FreeCodeCamp',
      url: 'https://www.freecodecamp.org/',
      desc: 'Free coding tutorials and certifications.',
    },
    {
      name: 'Web Dev Simplified',
      url: 'https://www.youtube.com/@WebDevSimplified',
      desc: 'YouTube channel for web development learning.',
    },
  ],
  'Cybersecurity & Privacy': [
    {
      name: 'IP Leak Test',
      url: 'https://ipleak.net/',
      desc: 'Reveals IP and browser information leaks.',
    },
    {
      name: 'Astrill VPN Test',
      url: 'https://www.astrill.com/vpn-leak-test',
      desc: 'Checks if VPN is leaking real IP/DNS.',
    },
    {
      name: 'Hacksplaining',
      url: 'https://www.hacksplaining.com/lessons',
      desc: 'Interactive security lessons for developers.',
    },
    {
      name: 'Hack My VM',
      url: 'https://hackmyvm.eu/dashboard/',
      desc: 'Vulnerable VMs for penetration testing practice.',
    },
    {
      name: 'PentestGPT',
      url: 'https://www.pentestgpt.ai/login',
      desc: 'AI assistant for penetration testers.',
    },
    {
      name: 'Phishy URL',
      url: 'https://phishyurl.com/',
      desc: 'Phishing simulation and awareness tool.',
    },
    {
      name: 'OSINT Framework',
      url: 'https://osintframework.com',
      desc: 'Visual directory of OSINT tools.',
    },
    {
      name: 'EFF Event',
      url: 'https://www.eff.org/event/eff-global-members-speakeasy-you-are-product',
      desc: 'EFF digital rights and privacy event.',
    },
    {
      name: 'Digital Security Reset',
      url: 'https://themultiverse.school/x/digital-security-reset',
      desc: 'Comprehensive digital security training.',
    },
    {
      name: 'Nostr',
      url: 'https://nostr.com/',
      desc: 'Decentralized social network protocol.',
    },
    {
      name: 'Bitwarden',
      url: 'https://bitwarden.com/',
      desc: 'Open-source password manager and vault.',
    },
    {
      name: 'HaveIBeenPwned',
      url: 'https://haveibeenpwned.com/',
      desc: 'Check if your personal data was breached.',
    },
    {
      name: 'ProtonVPN',
      url: 'https://protonvpn.com/',
      desc: 'Secure VPN service with privacy focus.',
    },
    {
      name: 'Mullvad VPN',
      url: 'https://mullvad.net/',
      desc: 'Privacy-focused VPN without account requirement.',
    },
    {
      name: 'Tor Browser',
      url: 'https://www.torproject.org/',
      desc: 'Browser for anonymous internet browsing.',
    },
  ],
  'Education, Career & Productivity': [
    {
      name: 'QuizMate',
      url: 'https://www.quizmate.io/',
      desc: 'AI study partner creating quizzes from notes.',
    },
    {
      name: 'Study.me',
      url: 'https://study.me/',
      desc: 'AI study planner for organizing learning.',
    },
    {
      name: 'Tango',
      url: 'https://www.tango.ai/',
      desc: 'Documentation tool creating step-by-step guides.',
    },
    {
      name: 'NodeDesk',
      url: 'https://nodesk.co/',
      desc: 'Remote jobs and digital nomad resources.',
    },
    {
      name: 'Hireflow',
      url: 'https://www.hireflow.net/',
      desc: 'Recruiting and candidate sourcing tool.',
    },
    {
      name: 'Careerflow AI',
      url: 'https://app.careerflow.ai',
      desc: 'AI career copilot for LinkedIn optimization.',
    },
    {
      name: 'Class Central',
      url: 'https://www.classcentral.com/',
      desc: 'Search engine for free online courses.',
    },
    {
      name: 'A Smart Bear',
      url: 'https://longform.asmartbear.com/customer-love/',
      desc: 'Customer retention and love strategies.',
    },
    {
      name: 'VCF Midwest',
      url: 'https://vcfmw.org/',
      desc: 'Vintage Computer Federation Midwest.',
    },
    {
      name: 'Lemire Blog',
      url: 'https://lemire.me/blog/2025/12/03/why-dont-we-get-more-scientific-breakthroughs/?utm_source=tldrnewsletter',
      desc: 'Thoughts on scientific breakthroughs.',
    },
    {
      name: 'LinkedIn',
      url: 'https://www.linkedin.com/',
      desc: 'Professional networking and job search platform.',
    },
    {
      name: 'Indeed',
      url: 'https://www.indeed.com/',
      desc: 'Job search engine with resume tools.',
    },
    {
      name: 'Glassdoor',
      url: 'https://www.glassdoor.com/',
      desc: 'Company reviews and salary transparency.',
    },
    {
      name: 'AngelList',
      url: 'https://www.angel.co/',
      desc: 'Startup jobs and equity opportunities.',
    },
    {
      name: 'Product Hunt',
      url: 'https://www.producthunt.com/',
      desc: 'Discover and showcase new products.',
    },
  ],
  'Utilities & Miscellaneous': [
    {
      name: 'TV.Garden',
      url: 'https://tv.garden/',
      desc: 'Interactive globe for live TV broadcasts worldwide.',
    },
    {
      name: 'LocalSend',
      url: 'https://localsend.org/download',
      desc: 'Secure file sharing between local devices.',
    },
    {
      name: 'Skyscanner',
      url: 'https://www.skyscanner.com/',
      desc: 'Travel search for flights and hotels.',
    },
    {
      name: 'Do Not Pay',
      url: 'https://donotpay.com',
      desc: 'AI robot lawyer for consumer disputes.',
    },
    {
      name: 'TDEE Calculator',
      url: 'https://tdeecalculator.net/',
      desc: 'Calculates daily energy expenditure.',
    },
    {
      name: 'Muscle Wiki',
      url: 'https://musclewiki.com/',
      desc: 'Fitness resource for muscle exercises.',
    },
    {
      name: 'Top Tier Gas',
      url: 'https://www.toptiergas.com/',
      desc: 'Fuel quality information and locator.',
    },
    {
      name: 'Hamina',
      url: 'https://www.hamina.com/',
      desc: 'Data center information and tracking.',
    },
    {
      name: 'RGB Squared',
      url: 'https://link.rgbsquared.com/',
      desc: 'LED lighting and RGB components.',
    },
    {
      name: 'Find Help',
      url: 'https://www.findhelp.org/provider/northside-housing-%2526-supportive-services--chicago-il/6526016887455744?postal=60640',
      desc: 'Social services and support resources.',
    },
    {
      name: 'Crunchlabs Space',
      url: 'https://space.crunchlabs.com/?type=t-mobile',
      desc: 'Mechanical engineering and robotics kits.',
    },
    {
      name: 'Masto Gizmos',
      url: 'https://mastogizmos.com/',
      desc: 'Mastodon-related tools and utilities.',
    },
    {
      name: 'Pivot Point',
      url: 'https://pivotpoint.zenoti.com',
      desc: 'Beauty industry salon management.',
    },
    {
      name: 'LightKey',
      url: 'https://sites.fastspring.com/lightkey/product/all',
      desc: 'Keyboard shortcut and typing tool.',
    },
    {
      name: 'YouTube Video',
      url: 'https://www.youtube.com/watch?v=Cbp_nXMLonw',
      desc: 'Educational or reference video.',
    },
    {
      name: 'Video Mapping Guide',
      url: 'https://solstice-hell-d2a.notion.site/Master-the-Art-of-Video-Mapping-b564ae5d7e944c6489719c75c6c3a0fd',
      desc: 'Comprehensive video mapping tutorial.',
    },
    {
      name: 'Notion',
      url: 'https://www.notion.so/',
      desc: 'All-in-one workspace for notes and organization.',
    },
    {
      name: 'Obsidian',
      url: 'https://obsidian.md/',
      desc: 'Privacy-first knowledge management tool.',
    },
    {
      name: 'Roam Research',
      url: 'https://roamresearch.com/',
      desc: 'Networked thinking tool for knowledge graphs.',
    },
    {
      name: 'Evernote',
      url: 'https://evernote.com/',
      desc: 'Note-taking and information organization platform.',
    },
    {
      name: 'Bear',
      url: 'https://bear.app/',
      desc: 'Beautiful note-taking app for Apple devices.',
    },
    {
      name: 'Todoist',
      url: 'https://todoist.com/',
      desc: 'Task management and productivity tracker.',
    },
    {
      name: 'Motion',
      url: 'https://www.motion.app/',
      desc: 'AI-powered calendar and task management.',
    },
    {
      name: 'Codeium',
      url: 'https://codeium.com/',
      desc: 'Free AI code completion tool.',
    },
  ],
};

let trackedData = {};

function saveData() {
  localStorage.setItem('linkTrackerData', JSON.stringify(trackedData));
}

function loadData() {
  const saved = localStorage.getItem('linkTrackerData');
  if (saved) {
    trackedData = JSON.parse(saved);
  } else {
    Object.keys(linksData).forEach((category) => {
      linksData[category].forEach((link) => {
        const key = link.url;
        trackedData[key] = {
          reviewed: false,
          used: false,
          notes: '',
          name: link.name,
          category: category,
        };
      });
    });
    saveData();
  }
}

function renderCategories() {
  const container = document.getElementById('categories-container');
  container.innerHTML = '';

  const categoryFilter = document.getElementById('category-filter').value;
  const searchTerm = document
    .getElementById('search-input')
    .value.toLowerCase();

  Object.entries(linksData).forEach(([category, links]) => {
    if (categoryFilter && category !== categoryFilter) return;

    const filteredLinks = links.filter((link) => {
      return (
        link.name.toLowerCase().includes(searchTerm) ||
        link.desc.toLowerCase().includes(searchTerm)
      );
    });

    if (filteredLinks.length === 0) return;

    const categoryDiv = document.createElement('div');
    categoryDiv.className = 'category';
    categoryDiv.dataset.category = category;

    categoryDiv.innerHTML = `
            <div class="category-header">
                <div>${category} <span style="font-weight: normal; margin-left: 10px; opacity: 0.8;">(${
      filteredLinks.length
    })</span></div>
                <span class="category-toggle">▼</span>
            </div>
            <div class="category-items">
                ${filteredLinks
                  .map(
                    (link) => `
                    <div class="link-item ${
                      trackedData[link.url]?.reviewed ? 'reviewed' : ''
                    } ${trackedData[link.url]?.used ? 'used' : ''}">
                        <div class="link-header">
                            <div class="link-title">
                                <div class="link-name">${link.name}</div>
                                <a class="link-url" href="${
                                  link.url
                                }" target="_blank" rel="noopener noreferrer">${
                      link.url
                    }</a>
                                <div class="link-desc">${link.desc}</div>
                            </div>
                            <div class="checkbox-group">
                                <div class="checkbox-wrapper">
                                    <input type="checkbox" class="reviewed-check" data-url="${
                                      link.url
                                    }" ${
                      trackedData[link.url]?.reviewed ? 'checked' : ''
                    }>
                                    <label class="checkbox-label">Reviewed</label>
                                </div>
                                <div class="checkbox-wrapper">
                                    <input type="checkbox" class="used-check" data-url="${
                                      link.url
                                    }" ${
                      trackedData[link.url]?.used ? 'checked' : ''
                    }>
                                    <label class="checkbox-label">Used</label>
                                </div>
                            </div>
                        </div>
                        <div class="link-notes">
                            <textarea class="notes-input" data-url="${
                              link.url
                            }" placeholder="Add notes about this link...">${
                      trackedData[link.url]?.notes || ''
                    }</textarea>
                        </div>
                    </div>
                `,
                  )
                  .join('')}
            </div>
        `;

    container.appendChild(categoryDiv);
  });

  if (container.children.length === 0) {
    container.innerHTML =
      '<div class="empty-state"><p>No links found matching your criteria.</p></div>';
  }

  // Attach listeners to dynamically created elements
  attachDynamicListeners();
}

function attachDynamicListeners() {
  document.querySelectorAll('.category-header').forEach((header) => {
    header.addEventListener('click', () => {
      const items = header.nextElementSibling;
      items.classList.toggle('hidden');
      header.querySelector('.category-toggle').textContent =
        items.classList.contains('hidden') ? '▶' : '▼';
    });
  });

  document.querySelectorAll('.reviewed-check').forEach((checkbox) => {
    checkbox.addEventListener('change', (e) => {
      trackedData[e.target.dataset.url].reviewed = e.target.checked;
      e.target.closest('.link-item').classList.toggle('reviewed');
      saveData();
      updateStats();
    });
  });

  document.querySelectorAll('.used-check').forEach((checkbox) => {
    checkbox.addEventListener('change', (e) => {
      trackedData[e.target.dataset.url].used = e.target.checked;
      e.target.closest('.link-item').classList.toggle('used');
      saveData();
      updateStats();
    });
  });

  document.querySelectorAll('.notes-input').forEach((textarea) => {
    textarea.addEventListener('input', (e) => {
      trackedData[e.target.dataset.url].notes = e.target.value;
      saveData();
    });
  });
}

function updateStats() {
  const totalLinks = Object.keys(trackedData).length;
  const reviewedCount = Object.values(trackedData).filter(
    (d) => d.reviewed,
  ).length;
  const usedCount = Object.values(trackedData).filter((d) => d.used).length;

  document.getElementById('total-links').textContent = totalLinks;
  document.getElementById('reviewed-count').textContent = reviewedCount;
  document.getElementById('used-count').textContent = usedCount;
}

function exportData() {
  let csv = 'Category,Name,URL,Reviewed,Used,Notes\n';

  Object.entries(trackedData).forEach(([url, data]) => {
    const reviewed = data.reviewed ? 'Yes' : 'No';
    const used = data.used ? 'Yes' : 'No';
    const notes = (data.notes || '').replace(/"/g, '""');
    csv += `"${data.category}","${data.name}","${url}","${reviewed}","${used}","${notes}"\n`;
  });

  const blob = new Blob([csv], { type: 'text/csv' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = `link-tracker-${new Date().toISOString().split('T')[0]}.csv`;
  link.click();
}

function clearAllData() {
  if (
    confirm(
      'Are you sure you want to clear all your progress? This cannot be undone.',
    )
  ) {
    Object.keys(trackedData).forEach((key) => {
      trackedData[key] = {
        reviewed: false,
        used: false,
        notes: '',
        name: trackedData[key].name,
        category: trackedData[key].category,
      };
    });
    saveData();
    renderCategories();
    updateStats();
  }
}

function scrollToStats() {
  const stats = document.querySelector('.header-stats');
  if (stats) {
    stats.scrollIntoView({ behavior: 'smooth' });
  }
}

function expandAllCategories() {
  document.querySelectorAll('.category-items').forEach((items) => {
    items.classList.remove('hidden');
  });
  document.querySelectorAll('.category-toggle').forEach((toggle) => {
    toggle.textContent = '▼';
  });
}

function collapseAllCategories() {
  document.querySelectorAll('.category-items').forEach((items) => {
    items.classList.add('hidden');
  });
  document.querySelectorAll('.category-toggle').forEach((toggle) => {
    toggle.textContent = '▶';
  });
}

function init() {
  loadData();
  renderCategories();
  updateStats();

  // Top-level controls
  const searchInput = document.getElementById('search-input');
  const categoryFilter = document.getElementById('category-filter');
  const expandAllBtn = document.getElementById('expand-all-btn');
  const collapseAllBtn = document.getElementById('collapse-all-btn');
  const exportBtn = document.getElementById('export-btn');
  const clearBtn = document.getElementById('clear-btn');
  const viewProgressLink = document.getElementById('view-progress-link');

  if (searchInput) {
    searchInput.addEventListener('input', () => {
      renderCategories();
    });
  }

  if (categoryFilter) {
    categoryFilter.addEventListener('change', () => {
      renderCategories();
    });
  }

  if (expandAllBtn) {
    expandAllBtn.addEventListener('click', () => {
      expandAllCategories();
    });
  }

  if (collapseAllBtn) {
    collapseAllBtn.addEventListener('click', () => {
      collapseAllCategories();
    });
  }

  if (exportBtn) {
    exportBtn.addEventListener('click', () => {
      exportData();
    });
  }

  if (clearBtn) {
    clearBtn.addEventListener('click', () => {
      clearAllData();
    });
  }

  if (viewProgressLink) {
    viewProgressLink.addEventListener('click', (e) => {
      e.preventDefault();
      scrollToStats();
    });
  }
}

document.addEventListener('DOMContentLoaded', init);
